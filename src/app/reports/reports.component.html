<div class="reports-container">
  <div class="reports-header">
    <h1>Relatórios</h1>
    <p>Gerencie e visualize relatórios do sistema Capsa Desk</p>
  </div>

  <!-- Navegação -->
  <nav class="reports-nav">
    <button 
      (click)="currentSection = 'create'" 
      [class.active]="currentSection === 'create'"
      class="nav-btn">
      <span class="material-icons">add</span>
      Criar Relatório
    </button>
    <button 
      (click)="currentSection = 'my-reports'" 
      [class.active]="currentSection === 'my-reports'"
      class="nav-btn">
      <span class="material-icons">list</span>
      Meus Relatórios
    </button>
    <button 
      (click)="currentSection = 'all-reports'" 
      [class.active]="currentSection === 'all-reports'"
      class="nav-btn">
      <span class="material-icons">visibility</span>
      Todos os Relatórios
    </button>
    <button 
      *ngIf="isAdmin"
      (click)="currentSection = 'pending'" 
      [class.active]="currentSection === 'pending'"
      class="nav-btn">
      <span class="material-icons">pending</span>
      Pendentes ({{ pendingReports.length }})
    </button>
  </nav>

  <!-- Conteúdo -->
  <div class="reports-content">
    <!-- Criar Relatório -->
    <section *ngIf="currentSection === 'create'" class="section-content">
      <h2>Criar Novo Relatório</h2>
      
      <div class="form-container">
        <div class="form-row">
          <div class="form-group">
            <label>Título do Relatório</label>
            <input 
              type="text" 
              [(ngModel)]="newReport.title" 
              placeholder="Ex: Relatório Semanal - Vendas"
              class="form-input">
          </div>

          <div class="form-group">
            <label>Tipo de Relatório</label>
            <select [(ngModel)]="newReport.type" class="form-select">
              <option value="weekly">Relatório Semanal</option>
              <option value="monthly">Relatório Mensal</option>
              <option value="quarterly">Relatório Trimestral</option>
            </select>
          </div>

          <div class="form-group">
            <label>Departamento</label>
            <select [(ngModel)]="newReport.department" class="form-select">
              <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Conteúdo do Relatório</label>
          <textarea 
            [(ngModel)]="newReport.content" 
            placeholder="Descreva as atividades realizadas, resultados obtidos, desafios encontrados e próximos passos..."
            rows="8"
            class="form-textarea"></textarea>
        </div>

        <div class="form-actions">
          <button (click)="createReport()" class="btn-primary" [disabled]="!newReport.title || !newReport.content">
            <span class="material-icons">save</span>
            Criar Relatório
          </button>
        </div>
      </div>
    </section>

    <!-- Meus Relatórios -->
    <section *ngIf="currentSection === 'my-reports'" class="section-content">
      <h2>Meus Relatórios</h2>
      
      <div class="reports-grid">
        <div *ngFor="let report of myReports" class="report-card">
          <div class="report-header">
            <h3>{{ report.title }}</h3>
            <div class="report-meta">
              <span class="report-type">{{ report.type === 'weekly' ? 'Semanal' : 'Mensal' }}</span>
              <span class="report-status" [class]="getStatusClass(report.status)">
                {{ getStatusText(report.status) }}
              </span>
            </div>
          </div>
          
          <div class="report-info">
            <span class="material-icons">calendar_today</span>
            {{ report.createdAt | date:'dd/MM/yyyy' }}
            <span class="material-icons">business</span>
            {{ report.department }}
          </div>

          <p class="report-content">{{ report.content }}</p>

          <div *ngIf="report.reviewedBy" class="review-info">
            <span class="material-icons">verified</span>
            Revisado por {{ report.reviewedBy }} em {{ report.reviewedAt | date:'dd/MM/yyyy' }}
          </div>

          <div class="report-actions">
            <button *ngIf="report.status === 'pending'" (click)="deleteReport(report.id)" class="btn-danger">
              <span class="material-icons">delete</span>
              Excluir
            </button>
          </div>
        </div>
      </div>

      <div *ngIf="myReports.length === 0" class="empty-state">
        <span class="material-icons">description</span>
        <h3>Nenhum relatório encontrado</h3>
        <p>Você ainda não criou nenhum relatório.</p>
      </div>
    </section>

    <!-- Todos os Relatórios -->
    <section *ngIf="currentSection === 'all-reports'" class="section-content">
      <h2>Todos os Relatórios</h2>
      
      <div class="reports-grid">
        <div *ngFor="let report of allReports" class="report-card">
          <div class="report-header">
            <h3>{{ report.title }}</h3>
            <div class="report-meta">
              <span class="report-type">{{ report.type === 'weekly' ? 'Semanal' : 'Mensal' }}</span>
              <span class="report-status" [class]="getStatusClass(report.status)">
                {{ getStatusText(report.status) }}
              </span>
            </div>
          </div>
          
          <div class="report-info">
            <span class="material-icons">person</span>
            {{ report.author }}
            <span class="material-icons">calendar_today</span>
            {{ report.createdAt | date:'dd/MM/yyyy' }}
            <span class="material-icons">business</span>
            {{ report.department }}
          </div>

          <p class="report-content">{{ report.content }}</p>

          <div *ngIf="report.reviewedBy" class="review-info">
            <span class="material-icons">verified</span>
            Revisado por {{ report.reviewedBy }} em {{ report.reviewedAt | date:'dd/MM/yyyy' }}
          </div>
        </div>
      </div>
    </section>

    <!-- Relatórios Pendentes -->
    <section *ngIf="currentSection === 'pending' && isAdmin" class="section-content">
      <h2>Relatórios Pendentes</h2>
      
      <div class="reports-grid">
        <div *ngFor="let report of pendingReports" class="report-card pending">
          <div class="report-header">
            <h3>{{ report.title }}</h3>
            <div class="report-meta">
              <span class="report-type">{{ report.type === 'weekly' ? 'Semanal' : 'Mensal' }}</span>
              <span class="report-status status-pending">Pendente</span>
            </div>
          </div>
          
          <div class="report-info">
            <span class="material-icons">person</span>
            {{ report.author }}
            <span class="material-icons">calendar_today</span>
            {{ report.createdAt | date:'dd/MM/yyyy' }}
            <span class="material-icons">business</span>
            {{ report.department }}
          </div>

          <p class="report-content">{{ report.content }}</p>

          <div class="report-actions">
            <button (click)="approveReport(report.id)" class="btn-primary">
              <span class="material-icons">check</span>
              Aprovar
            </button>
            <button (click)="deleteReport(report.id)" class="btn-danger">
              <span class="material-icons">close</span>
              Rejeitar
            </button>
          </div>
        </div>
      </div>

      <div *ngIf="pendingReports.length === 0" class="empty-state">
        <span class="material-icons">check_circle</span>
        <h3>Nenhum relatório pendente</h3>
        <p>Todos os relatórios foram revisados.</p>
      </div>
    </section>
  </div>
</div>